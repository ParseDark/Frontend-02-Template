{"version":3,"sources":["gesture.js","index.js"],"names":["Dispatcher","element","type","properties","event","Event","name","dispatchEvent","dispatch","Listener","recognizer","contexts","Map","isListeningMouse","addEventListener","e","context","Object","create","set","button","start","mouseMove","buttons","key","get","move","mouseUp","end","delete","document","removeEventListener","changedTouches","touch","identifier","cancel","Recognizer","dispatcher","point","points","t","Date","now","x","clientX","y","clientY","startX","startY","isTap","isPan","isPress","handler","setTimeout","dx","dy","isVertical","Math","abs","clentX","clentY","clearTimeout","filter","push","d","v","length","sqrt","isFlick","velocity","enableGesture","documentElement"],"mappings":"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","file":"flick.e31bb0bc.js","sourceRoot":"..","sourcesContent":["\r\nexport class Dispatcher{\r\n    constructor(element) {\r\n        this.element = element;\r\n    }\r\n\r\n    dispatch(type, properties) {\r\n        let event = new Event(type);\r\n        for(let name in properties) {\r\n            event[name] = properties[name];\r\n        }\r\n\r\n        this.element.dispatchEvent(event);\r\n    }\r\n}\r\n\r\nexport function dispatch(type, properties) {\r\n    let event = new Event(type);\r\n    for(let name in properties) {\r\n        event[name] = properties[name];\r\n    }\r\n\r\n    element.dispatchEvent(event);\r\n}\r\n\r\n\r\n// 信息流向： Listener => recognize => dispatch\r\n\r\n// new Listener(new Recognizer(dispatch))\r\n\r\nexport class Listener {\r\n    constructor(element, recognizer) {\r\n        let contexts = new Map();\r\n        let isListeningMouse = false;\r\n\r\n        element.addEventListener('mousedown', (e) => {\r\n            let context = Object.create(null);\r\n            contexts.set(\"mouse\" + (1 << e.button), context);\r\n\r\n            recognizer.start(e, context);\r\n\r\n            let mouseMove = event => {\r\n                let button = 1;\r\n\r\n                while(button <= event.buttons) {\r\n                   if(button & event.buttons) {\r\n                        // order of buttons & button property is not same\r\n                        let key;\r\n                        if(button === 2) {\r\n                            key = 4;\r\n                        } else if(button === 4)  {\r\n                            key = 2;\r\n                        } else {\r\n                            key = button;\r\n                        }\r\n                        \r\n                        let context = contexts.get('mouse' + key);\r\n                        recognizer.move(event, context);\r\n                    }\r\n                    button = button << 1;\r\n                }\r\n                \r\n                \r\n            };\r\n            let mouseUp = event => {\r\n                let context = contexts.get('mouse' + (1 << event.button));\r\n\r\n                recognizer.end(event, context);\r\n\r\n                contexts.delete('mouse' + (1 << event.button));\r\n\r\n                if(event.buttons === 0) {\r\n                    document.removeEventListener('mousemove', mouseMove);\r\n                    document.removeEventListener('mouseup', mouseUp);\r\n                    isListeningMouse = false;\r\n                }\r\n        };\r\n\r\n            if(!isListeningMouse) {\r\n                document.addEventListener('mousemove', mouseMove);\r\n                document.addEventListener('mouseup', mouseUp);\r\n                isListeningMouse = true;\r\n            }\r\n        });\r\n\r\n\r\n\r\n\r\n        // event 可以存在多个触点, 多点触控\r\n        element.addEventListener('touchstart', event => {\r\n            for(let touch of event.changedTouches) {\r\n                let context = Object.create(null);\r\n                contexts.set(touch.identifier, context);\r\n                recognizer.start(touch, context);\r\n            }\r\n\r\n        });\r\n\r\n\r\n        element.addEventListener('touchmove', event => {\r\n            for(let touch of event.changedTouches) {\r\n                let context = contexts.get(touch.identifier);\r\n                recognizer.move(touch, context);\r\n            }\r\n        });\r\n\r\n        element.addEventListener('touchend', event => {\r\n            for(let touch of event.changedTouches) {\r\n                let context = contexts.get(touch.identifier);\r\n                recognizer.end(touch, context);\r\n                contexts.delete(touch.identifier);\r\n            }\r\n        });\r\n\r\n        element.addEventListener('touchcancel', event => {\r\n            for(let touch of event.changedTouches) {\r\n                recognizer.cancel(touch, context);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport class Recognizer {\r\n    constructor(dispatcher) {\r\n        this.dispatcher = dispatcher;\r\n    }\r\n    start (point, context) {\r\n        context.points = [{\r\n            t: Date.now(),\r\n            x: point.clientX,\r\n            y: point.clientY,\r\n        }];\r\n\r\n        context.startX = point.clientX;\r\n        context.startY = point.clientY;\r\n\r\n        context.isTap = true;\r\n        context.isPan = false;\r\n        context.isPress = false;\r\n\r\n        context.handler = setTimeout(() => {\r\n            context.isTap = true;\r\n            context.isPan = false;\r\n            context.isPress = false;\r\n            context.handler = null;\r\n            this.dispatcher.dispatch('press', {});\r\n        }, 500);\r\n    }\r\n    move (point, context) {\r\n        let dx = point.clientX - context.startX;\r\n        let dy = point.clientY - context.startY;\r\n\r\n        // move 10px\r\n        if(!context.isPan && (dx ** 2 + dy ** 2 > 100)) {\r\n            context.isTap = false;\r\n            context.isPan = true;\r\n            context.isPress = false;\r\n            context.isVertical =  Math.abs(dx) < Math.abs(dy);\r\n    \r\n            this.dispatcher.dispatch('pressStart', {\r\n                startX: context.startX,\r\n                startY: context.startY,\r\n                clientX: point.clentX,\r\n                clientY: point.clentY,\r\n                isVertical:context.isVertical,\r\n            });\r\n            clearTimeout(context.handler);\r\n        }\r\n\r\n        if(context.isPan) {\r\n            this.dispatcher.dispatch('pan', {\r\n                startX: context.startX,\r\n                startY: context.startY,\r\n                clientX: point.clentX,\r\n                clientY: point.clentY,\r\n                isVertical:context.isVertical,\r\n            });\r\n        }\r\n\r\n        context.points = context.points.filter(point => Date.now() - point.t < 500);\r\n\r\n        context.points.push({\r\n            t: Date.now(),\r\n            x: point.clientX,\r\n            y: point.clientY\r\n        });\r\n    }\r\n    end (point, context) {\r\n        if(context.isTap) {\r\n            this.dispatcher.dispatch('tap', {});\r\n            clearTimeout(context.handler);\r\n        }\r\n\r\n        if(context.isPress) {\r\n            this.dispatcher.dispatch('pressEnd', {});\r\n        }\r\n\r\n        let d, v;\r\n\r\n        if(!context.points.length) {\r\n            v = 0;\r\n        } else {\r\n            context.points = context.points.filter(point => Date.now() - point.t < 500);\r\n            // computed the move speed\r\n            d = Math.sqrt((point.clientX - context.points[0].x) ** 2 + (point.clientY - context.points[0].y) ** 2 ) \r\n            v = d / (Date.now() - context.points[0].t);\r\n        }\r\n\r\n        if(v > 1.5) {\r\n            this.dispatcher.dispatch('flick', {\r\n                startX: context.startX,\r\n                startY: context.startY,\r\n                clientX: point.clentX,\r\n                clientY: point.clentY,\r\n                isVertical:context.isVertical,\r\n                isFlick: context.isFlick,\r\n                velocity: v,\r\n            });           \r\n            context.isFlick = true;\r\n        } else {\r\n            context.isFlick = false;\r\n        }\r\n\r\n         if(context.isPan) {\r\n            this.dispatcher.dispatch('panEnd', {\r\n                startX: context.startX,\r\n                startY: context.startY,\r\n                clientX: point.clentX,\r\n                clientY: point.clentY,\r\n                isVertical:context.isVertical,\r\n                isFlick: context.isFlick,\r\n            });\r\n        }\r\n    }\r\n    cancel (point, context) {\r\n        this.dispatcher.dispatch('cancel', {\r\n            startX: context.startX,\r\n            startY: context.startY,\r\n            clientX: point.clentX,\r\n            clientY: point.clentY,\r\n            isVertical:context.isVertical,\r\n            isFlick: context.isFlick,\r\n        });\r\n        clearTimeout(handler);\r\n    }\r\n}\r\n\r\nexport function enableGesture(element) {\r\n    new Listener(element, new Recognizer(new Dispatcher(element)));\r\n}","import { enableGesture } from './gesture.js'\n\ndebugger;\n\nenableGesture(document.documentElement);"]}